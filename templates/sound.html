<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Musique</title>
  </head>
  <body>
    <audio
      id="background-music"
      src="{{ url_for('static', filename='sound/background-music.mp3') }}"
      loop
      autoplay
    >
      Ton navigateur ne supporte pas d'éléments audio.
    </audio>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const audio = document.getElementById("background-music");
        const savedTime = sessionStorage.getItem("audioTime");
        if (savedTime) {
          if (audio.readyState > 0) {
            audio.currentTime = parseFloat(savedTime);
            audio.play();
          } else {
            audio.addEventListener("loadedmetadata", function () {
              audio.currentTime = parseFloat(savedTime);
              audio.play();
            });
          }
        }
      });

      window.addEventListener("beforeunload", function () {
        const audio = document.getElementById("background-music");
        sessionStorage.setItem("audioTime", audio.currentTime);
      });
    </script>
  </body>
</html>
